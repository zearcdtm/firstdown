import discord from discord.ext import commands from discord import app_commands, Interaction, Embed, ButtonStyle from discord.ui import View, Button import pytz GUILD_ID = 1443687099575570544 class Stream(commands.Cog): def __init__(self, bot): self.bot = bot @app_commands.command(name="stream", description="Announce a game stream") @app_commands.guilds(discord.Object(id=GUILD_ID)) @app_commands.describe( platform="Select Twitch or YouTube", link="Stream link", away_team="Away team role", home_team="Home team role", streamer="Streamer username or mention" ) @app_commands.choices(platform=[ app_commands.Choice(name="Twitch", value="twitch"), app_commands.Choice(name="YouTube", value="youtube") ]) async def stream(self, interaction: Interaction, platform: app_commands.Choice[str], link: str, away_team: discord.Role, home_team: discord.Role, streamer: str): await interaction.response.defer() embed_emoji = "<:twitch:1450676257304871015>" if platform.value=="twitch" else "<:youtube:1447369117215625318>" color = discord.Color.purple() if platform.value=="twitch" else discord.Color.red() embed = Embed( description=f"{embed_emoji} {away_team.mention} at {home_team.mention} is live!\nStreamer: {streamer}", color=color ) est = pytz.timezone("US/Eastern") timestamp = f"{pytz.datetime.datetime.now(est).strftime('%Y-%m-%d %I:%M %p ET')}" embed.set_footer(text=f"Approved by {streamer} | {timestamp}") view = View(timeout=None) view.add_item(Button(label=f"Watch on {platform.name}", emoji=embed_emoji, url=link, style=ButtonStyle.link)) await interaction.followup.send(embed=embed, view=view) async def setup(bot): await bot.add_cog(Stream(bot))
